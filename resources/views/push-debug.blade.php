<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Push –≤ Chrome</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .card {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #333; }
        h2 { color: #666; margin-top: 0; }
        .step { 
            margin: 15px 0; 
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #4285f4;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover { background: #357ae8; }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Chrome</h1>

    <div class="card">
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Chrome</h2>
        <div class="step">
            <strong>–®–∞–≥ 1:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Chrome<br>
            1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ (‚ãÆ) –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É<br>
            2. –í—ã–±–µ—Ä–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"<br>
            3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞"<br>
            4. –ù–∞–π–¥–∏—Ç–µ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
        </div>
        
        <div class="step">
            <strong>–®–∞–≥ 2:</strong> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã<br>
            - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à —Å–∞–π—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ "–†–∞–∑—Ä–µ—à–µ–Ω–æ"<br>
            - –ï—Å–ª–∏ –æ–Ω –≤ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ" - —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ –æ—Ç—Ç—É–¥–∞
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> Chrome –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –µ—Å–ª–∏:
            <ul>
                <li>–í—ã —Å–ª—É—á–∞–π–Ω–æ –Ω–∞–∂–∞–ª–∏ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è</li>
                <li>–°–∞–π—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</li>
                <li>–í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º "–ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å" –≤ Windows</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <h2>2. –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h2>
        <button onclick="checkPermissions()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è</button>
        <button onclick="checkServiceWorker()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Service Worker</button>
        <button onclick="checkSubscription()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
        <button onclick="checkNotificationAPI()">–¢–µ—Å—Ç Notification API</button>
        <button onclick="clearAndResubscribe()">–û—á–∏—Å—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
        
        <div id="results"></div>
    </div>

    <div class="card">
        <h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ DevTools</h2>
        <div class="step">
            <strong>–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)</strong><br>
            1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Application"<br>
            2. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ "Service Workers"<br>
            3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Worker –∞–∫—Ç–∏–≤–µ–Ω (–∑–µ–ª–µ–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)<br>
            4. –ù–∞–∂–º–∏—Ç–µ "Update" –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è<br>
            5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ "Push Messaging" - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
        </div>
    </div>

    <div class="card">
        <h2>4. –°–±—Ä–æ—Å –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫</h2>
        <div class="step">
            –í Chrome –≤–≤–µ–¥–∏—Ç–µ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ:<br>
            <code>chrome://settings/content/notifications</code><br><br>
            –ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Å–∞–π—Ç –∏ —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ –∏–∑ —Å–ø–∏—Å–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        </div>
    </div>

    <div class="card">
        <h2>5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Windows</h2>
        <div class="step">
            <strong>Windows 10/11:</strong><br>
            1. –û—Ç–∫—Ä–æ–π—Ç–µ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã Windows" (Win + I)<br>
            2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–°–∏—Å—Ç–µ–º–∞" ‚Üí "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"<br>
            3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã<br>
            4. –ù–∞–π–¥–∏—Ç–µ Chrome –≤ —Å–ø–∏—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –≤–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        </div>
    </div>

    <script>
        const log = (message, type = 'info') => {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            results.textContent += `[${timestamp}] ${prefix} ${message}\n`;
        };

        async function checkPermissions() {
            document.getElementById('results').textContent = '';
            log('–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π...');
            
            const permission = Notification.permission;
            log(`–¢–µ–∫—É—â–µ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ${permission}`, permission === 'granted' ? 'success' : 'error');
            
            if (permission === 'denied') {
                log('‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–´!', 'error');
                log('–†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ chrome://settings/content/notifications');
                log('–ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Å–∞–π—Ç –∏ —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ, –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            } else if (permission === 'default') {
                log('‚ö†Ô∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—Ä–æ—à–µ–Ω–æ. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è"');
            } else {
                log('‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!', 'success');
            }
        }

        async function checkServiceWorker() {
            document.getElementById('results').textContent = '';
            log('–ü—Ä–æ–≤–µ—Ä–∫–∞ Service Worker...');
            
            if (!('serviceWorker' in navigator)) {
                log('‚ùå Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                return;
            }
            
            try {
                const registration = await navigator.serviceWorker.getRegistration();
                if (registration) {
                    log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
                    log(`Scope: ${registration.scope}`);
                    log(`State: ${registration.active?.state || 'none'}`);
                } else {
                    log('‚ùå Service Worker –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function checkSubscription() {
            document.getElementById('results').textContent = '';
            log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏...');
            
            try {
                const registration = await navigator.serviceWorker.ready;
                const subscription = await registration.pushManager.getSubscription();
                
                if (subscription) {
                    log('‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞!', 'success');
                    log(`Endpoint: ${subscription.endpoint.substring(0, 50)}...`);
                } else {
                    log('‚ùå –ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç', 'error');
                    log('–ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function checkNotificationAPI() {
            document.getElementById('results').textContent = '';
            log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Notification API...');
            
            if (!('Notification' in window)) {
                log('‚ùå Notification API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                return;
            }
            
            if (Notification.permission !== 'granted') {
                log('‚ùå –ù–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', 'error');
                const permission = await Notification.requestPermission();
                log(`–ù–æ–≤–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ${permission}`);
                if (permission !== 'granted') return;
            }
            
            try {
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è...');
                const notification = new Notification('üîî –¢–µ—Å—Ç Chrome', {
                    body: '–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ - Notification API —Ä–∞–±–æ—Ç–∞–µ—Ç!',
                    icon: '/images/icons/icon.svg',
                    badge: '/images/icons/icon.svg',
                    tag: 'test-' + Date.now(),
                    requireInteraction: false
                });
                
                log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!', 'success');
                log('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª —ç–∫—Ä–∞–Ω–∞');
                
                notification.onclick = () => {
                    log('‚úÖ –ö–ª–∏–∫ –ø–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!', 'success');
                    notification.close();
                };
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function clearAndResubscribe() {
            document.getElementById('results').textContent = '';
            log('–û—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å–∫–∞...');
            
            try {
                // –û—Ç–ø–∏—Å—ã–≤–∞–µ–º—Å—è
                const registration = await navigator.serviceWorker.ready;
                const subscription = await registration.pushManager.getSubscription();
                
                if (subscription) {
                    await subscription.unsubscribe();
                    log('‚úÖ –°—Ç–∞—Ä–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
                }
                
                // –£–¥–∞–ª—è–µ–º Service Worker
                const allRegistrations = await navigator.serviceWorker.getRegistrations();
                for (let reg of allRegistrations) {
                    await reg.unregister();
                }
                log('‚úÖ Service Workers —É–¥–∞–ª–µ–Ω—ã', 'success');
                
                log('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –∑–∞–Ω–æ–≤–æ', 'success');
                
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>
